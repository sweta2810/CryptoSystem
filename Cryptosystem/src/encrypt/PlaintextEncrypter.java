package encrypt;

import java.math.BigInteger;

import adapters.ApacheCommonsMathAdapter;
import adapters.BigIntegerMatrixOperations;
import adapters.MatrixAdapter;
import adapters.StatisticsAdapter;

public class PlaintextEncrypter implements Encrypter{

	/**
	 * Encrypts a BigInteger matrix with a BigInteger public key as generated by the KeyGen class.
	 * @param plaintext a BigInteger matrix containing the plaintext to be encrypted
	 * @param publickey a public key generated by the KeyGen class.
	 * @return a BigInteger matrix containing the ciphertext.
	 */
	
	public BigInteger[][] encrypt(BigInteger[][] plaintext, BigInteger[][] publicKey) {
		MatrixAdapter ma = new BigIntegerMatrixOperations();
		StatisticsAdapter sa = new ApacheCommonsMathAdapter();
		MatrixGen gen = new MatrixGen(); 
		//need to get the correct parameters in here
		BigInteger[][] ranMatrix = gen.generateRandomMatrix();

		BigInteger[][] errorMatrix = sa.generateErrorMatrix();
		
		BigInteger[][] outMatrix = ma.mod(ma.add(ma.add(ma.multiply(publicKey, ranMatrix), ma.multiply(errorMatrix, BigInteger.valueOf(2))), plaintext), q); //need to access q...
		return outMatrix;

	}
}